<form class="contenteditable" style="background: white; width:850px; border:none !important;">
    <table style="background-color:lightgrey; border:none; padding:0px; margin:0px; width:852px">
        <tr>
            <td style="width:100px;">
                <img width="100" height="auto" style="border:0" id="avatar" data-edit="img" src="{{actor.img}}"></img>
            </td>
            <td style="width:275px;">
                <textarea name="name" rows="2" data-edit="name" style="font-size:xx-large; border:0; resize:none; font-family:Montserrat; font-weight:bold; color:black; text-shadow: 2px 2px 5px darkslategrey; background:lightgrey; height:auto; width:300px;">{{actor.name}}</textarea>
            </td>
            <td>
                <table style="background-color:lightgrey; border:0px; padding:0px; margin:0px">
                    <tr>
                        <td>
                            <b>Refresh: </b>
                        </td>
                        <td>
                            <input type="number" class="cs_box" data-edit="data.details.fatePoints.refresh" name="data.details.fatePoints.refresh" style="width:75px;" value="{{data.details.fatePoints.refresh}}"></input>
                        </td>
                        <td>
                            <b>Skill Points: </b>
                        </td>
                        <td>
                            <input type="number" name="skillTotal" disabled style="width:75px" value="{{skillTotal}}"></input>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Current: </b>
                        </td>
                        <td>
                            <input type="number" class="cs_box" name="data.details.fatePoints.current" style="width:75px" value="{{data.details.fatePoints.current}}"></input>
                        </td>
                        <td>
                            <b>Game Skill Total: </b>
                        </td>
                        <td>
                            <input type="number" name="gameSkillPoints" skillPoints " disabled style="width:75px " value="{{gameSkillPoints}} "></input>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Game Refresh:</b>
                    </td>
                    <td>
                        <input type="number " name="gameRefresh " disabled style="width:75px " value="{{gameRefresh}} "></input>
                    </td>
                    <td>
                        <b>Refresh Spent:</b>
                    </td>
                    <td>
                        <input type="number " name="refreshSpent " disabled style="width:75px " value="{{refreshSpent}} " title="Spent on Stunts: {{paidStunts}} (the game 's {{freeStunts}} free stunts have been deducted); Spent on tracks: {{paidTracks}}; Spent on Extras: {{paidExtras}}"></input>
                    </td>
                </tr>
                <tr>
                    <td colspan="2"></td>
                    <td colspan="2" style="height:75px; vertical-align:bottom; background-color:lightgrey">
                    <nav class="navigation foo">
                        <a class="item mf_item" data-tab="biography"><b title="Biography and Extras" i icon class="fas fa-portrait"></b></a>
                        <a class="item mf_item" data-tab="sheet"><b title="Character Sheet" i icon class="fas fa-clipboard"></b></a>
                    </nav>
                    </td>
                </tr>
            </table>
            </td>
        </tr>
    </table>
    
<section class="sheet-body">
<div name = "character_sheet" class="tab sheet" data-tab="sheet" style="padding-left:20px">
    <div id = "{{actor.name}}_sheet_div" class="tabcontent" style="display:block; font-size:small">
        <div style="display:flex; flex-flow:row wrap" name = "skills_aspects">
            <div name="skills_block">
                <div name = "skills_header" style="width:400px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7"><b>Skills</b>
                    <div title="Open the Skill Editor" style="font-size:medium; padding-left:10px; padding-right:10px; padding-top:5px; float:right;" name="edit_player_skills" i icon class="fas fa-cog"></div><div style="font-size:medium; padding-right:10px; padding-top:5px; float:right" name="sort_player_skills" i icon class="fas fa-sort" title="Switch between sorting by rank and sorting by name"></div></div>
                <div name = "skills_body" id="skills_body" style="overflow-y:auto; width:400px; max-height:300px; min-height:100px; padding-top:10px; scrollbar-width:thin; font-family:Montserrat">
                {{#if sortByRank}}
                {{#each sorted_by_rank}}
                    <div class = "row">
                        <div class="column" style="float:left; padding-left:2px; width:10%; margin:auto; padding-top:2px; padding-bottom:2px; border-bottom:1px solid lightsteelblue">{{this.rank}}</div>
                        <div class="column" style="float:left; width:30%; margin:auto; padding-top:2px; padding-bottom:2px; border-bottom:1px solid lightsteelblue">({{lookup ../ladder this.rank}})</div>
                        <div class="column" name="skill" style="float:left; width:60%; padding-top:2px; margin:auto; padding-bottom:2px; border-bottom:1px solid lightsteelblue" id="{{this.name}}">{{this.name}}<i id="{{this.name}}" style="float:right; padding-right:10px" icon class="fas fa-dice"></i></div>
                    </div>
                {{/each}}
                {{else}}
                {{#each ordered_skills}}    
                <div class="row">
                    <div class="column" style="float:left; padding-left:2px; width:10%; margin:auto; padding-top:2px; padding-bottom:2px; border-bottom:1px solid lightsteelblue">{{this.rank}}</div>
                    <div class="column" style="float:left; width:30%; margin:auto; padding-top:2px; padding-bottom:2px; border-bottom:1px solid lightsteelblue">({{lookup ../ladder this.rank}})</div>
                    <div class="column" name="skill" style="float:left; width:60%; padding-top:2px; margin:auto; padding-bottom:2px; border-bottom:1px solid lightsteelblue" id="{{this.name}}">{{this.name}}<i id="{{this.name}}" style="float:right; padding-right:10px" icon class="fas fa-dice"></i></div>
                </div>
                {{/each}}
                {{/if}}
            </div><!--End of skills body-->
        </div><!--end of skills block-->
        <div name = "aspects_block" style="float:left; padding-left:10px">
            <div name = "aspects_header" style="width:400px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7"><b>Aspects</b>{{#if GM}}<div title="Open the Aspect Editor" style="font-size:medium; padding-left:10px; padding-right:10px; padding-top:5px; float:right" name="edit_player_aspects" i icon class="fas fa-cog"></div>{{/if}}</div>
            <div name = "aspects_body" id="aspects_body" style="overflow-y:auto; width:400px; min-height:100px; max-height:300px; padding-top:10px; scrollbar-width:thin">
                {{#each data.aspects}}
                <div class="row">
                    <div name="aspect" style="float:left, width 25%; margin:auto; padding:1px; font-family:Montserrat; font-weight:bold"  title="{{this.description}}">
                            <div id="{{this.name}}" name="{{this.name}}">{{this.name}}</div>
                            <input class="cs_box" type="text" {{this.name}}" name="data.aspects.{{this.name}}.value" value="{{{this.value}}}"></input>
                        </div>
                </div><!--End of a row-->
                {{/each}}
            </div><!--End of aspects body-->
        </div><!--End of aspects block-->
    </div><!--end of skills_aspects-->

    <!--------------------Begin tracks and stunts section-->
    <div style="display:flex; flex-flow:row wrap" name = "tracks_stunts"><!--Begin tracks & stunts section-->
        <div name = "tracks_block"><!--Begin the tracks block-->
            <div name="tracks_header" style="width:400px; padding-top:10px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7"><b>Tracks</b><div title="Open the Track Editor" style="font-size:medium; padding-left:10px; padding-right:10px; padding-top:5px; float:right" name="edit_player_tracks" i icon class="fas fa-cog"></div></div>
            <div name = "tracks_body" id="tracks_body" style="overflow-y:auto; width:400px; padding-top:10px; min-height:100px; max-height:400px;scrollbar-width:thin">
                <table style="background-color:white; border:0px; padding:10px;">
                    {{#each tracks}}{{#if this.enabled}}
                    <tr>
                        <td style="padding-bottom:10px; width:120px">
                            <div name="track_name" style="font-family:Montserrat" title="Click here to edit the track notes for {{this.name}}"><i style="font-style:normal; font-weight:bold; font-family: Montserrat">{{this.name}}</i></div>
                        </td>
                        <td style="padding-bottom:10px">
                            {{#each this.box_values}}
                            {{#if this}}
                            <label class="box"><input type="checkbox" name = "box" id="{{../name}}_{{@index}}_false" style="opacity:0;width:25px; height:25px; float:left;" checked="checked"><span class = "checkmark"></span><i style="font-style:normal; position: absolute; left: 0; top: 0; transform: translate(-55%, -35%); font-weight: 900; font-size: 20px; color: #2f3542; text-shadow: 2px 2px 0px white;">{{#if (eq ../label "escalating")}}{{add1 @index}}{{else}}{{#if (eq ../label "none")}}{{else}}{{../label}}{{/if}}{{#if (eq ../harm_can_absorb 0)}}{{else}}{{../harm_can_absorb}}{{/if}}{{/if}}</i></label>{{else}}                          
                            <label class="box"><input type="checkbox" name="box" id="{{../name}}_{{@index}}_true" style="opacity:0; width:25px; height:25px; float:left;"><span class = "checkmark"></span><i style="font-style:normal; position: absolute; left: 0; top: 0; transform: translate(-55%, -35%); font-weight: 900; font-size: 20px; color: #2f3542; text-shadow: 2px 2px 0px #f1f2f6;">{{#if (eq ../label "escalating")}}{{add1 @index}}{{else}}{{#if (eq ../label "none")}}{{else}}{{../label}}{{/if}}{{#if (eq ../harm_can_absorb 0)}}{{else}}{{../harm_can_absorb}}{{/if}}{{/if}}</i></input></label>{{/if}}
                            {{/each}}
                            {{#if this.aspect.when_marked}}{{#if (hasBoxes this)}}{{else}}<label style="font-weight:900; padding-left:2px">{{this.harm_can_absorb}}</label>{{/if}}<input type="text" class="aspect_box" name = "data.tracks.{{this.name}}.aspect.name" value ="{{this.aspect.name}}"><i style="font-style:normal; position: absolute; left: 0; top: 0; transform: translate(-55%, -35%); font-weight: 900; font-size: 24px; color: #2f3542; text-shadow: 2px 2px 2px white;"></i></input>{{/if}}
                        </td>
                    </tr>
                    {{/if}}{{/each}}
                </table>
                <img src = "systems/ModularFate/assets/pbf.svg" style="height:75px; width:auto; border:none;"/>
            </div><!--end of tracks body-->
        </div><!--End of tracks block-->


        <!-------BEGIN THE STUNTS SECTION, UNLEASH THE HOUNDS-->
        <div name="stunts_block" style="float:left; padding-left:10px; padding-top:10px"> <!--Begin the stunts block-->
            <div name = "stunts_header" style="width:400px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7"><b>Stunts</b><div title="Add a new stunt" style="font-size:medium; padding-left:10px; padding-right:10px; padding-top:5px; float:right" name="edit_player_stunts" i icon class="fas fa-plus"></div></div>
            <div name = "stunts_body" id="stunts_body" style="overflow-y:auto; font-family:Montserrat; width:400px; min-height:100px; max-height:400px; padding-top:10px; scrollbar-width:thin">
                <table style="background:white; color:black; border:none">
                {{#each stunts}}
                    <tr>
                        <td style="font-weight:bold; font-family:Montserrat;">{{this.name}} ({{this.linked_skill}})<button type="button" style="border:none; background:white; float:right; width:20px; height:20px;" i icon class = "fas fa-trash" name="delete_stunt" id="{{this.name}}_delete"></button> {{#if (eq this.linked_skill "None")}}{{else}}<button type="button" name = "stunt_name" id="{{this.name}}_{{this.linked_skill}}_{{this.bonus}}" style="border:none; background:white; float:right; width:20px; height:20px; padding-left:15px; padding-right:30px" i icon class = "fas fa-dice""></button>{{/if}}<button type="button" name="edit_stunt" style="border:none; float:right; width:20px; height:20px; background:white" i icon class = "fas fa-edit" id="{{this.name}}_edit"></button></td>
                    </tr>
                    <tr>
                        <td>{{{this.description}}}</td>
                    </tr>
                    <tr>
                        <td style="font-family:Fate Core; font-size:large; padding-bottom:20px">
                            {{#if this.overcome}}<b id="Overcome">O</b>{{/if}}{{#if this.caa}}<b id="Create An Advantage">C</b>{{/if}}{{#if this.attack}}<b id="Attack">A</b>{{/if}}{{#if this.defend}}<b id="Defend">D</b>{{/if}}
                        </td>
                    </tr>
                    {{/each}}
                </table>
            </div><!--End of stunt body-->
        </div><!-- end of Stunts block-->
    </div><!--end of Tracks and stunts section-->
</div> <!--End of sheet tab-->
</div><!--end of character sheet-->

<div class="tab biography" id="biography_body" data-tab="biography" style="padding-left:20px">
    <div>
        <div style="width:800px; padding-top:10px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7">
            <b>Description:</b>
        </div>
        <div style="width:800px">
            <div class="long_text" id="{{this.actor._id}}_description" contenteditable="true" name="data.details.description.value" data-edit="data.details.description.value">{{{data.details.description.value}}}</div><p/>
        </div>
        <div style="width:800px; padding-top:10px; font-size:14pt; font-family:Montserrat; padding-bottom:2px; border-bottom:2px solid #2273b7">
            <b>Biography:</b>
        </div>
        <div style="width:800px">
            <div class="long_text" id="{{this.actor._id}}_biography" contenteditable="true" data-edit="data.details.biography.value" name="data.details.biography.value">{{{data.details.biography.value}}}</div></p>
        </div>
    </div><!--end of bio block-->


    <div><!--Begin Extras block-->
        <div name = "Extras header" style="width:800px; padding-top:10px; font-family:Montserrat; font-size:14pt; padding-bottom:2px; border-bottom:2px solid #2273b7"><b>Extras:</b><div title="Add a new Extra" style="font-size:medium; padding-left:10px; padding-right:10px; padding-top:5px; float:right" name="add_player_extra" i icon class="fas fa-plus"></div></div>
        <div name = "extras_body" style="overflow-y:auto; width:800px; height:auto;"">
            <table style="background:white; color:black; border:none">
                {{#each items}}
                    <tr>
                        <td style="font-weight:bold; font-family:Montserrat">{{{this.name}}}<button style="border:none; background-color:white; float:right; width:20px; height:20px" i icon class = "fas fa-trash" type="button" name="delete_extra" id="{{this._id}}"></button><button name="edit_extra" type="button" style="border:none; background-color:white; float:right; width:20px; height:20px" i icon class = "fas fa-edit" id="{{this._id}}"></button></td>
                    </tr>
                    <tr>
                        <td style="padding-bottom:20px; font-family:Montserrat">{{{this.data.description.value}}}</td>
                    </tr>
                    {{/each}}
                </table>
        </div><!--End of Extras Body block-->
         </div><!--End of Extras block-->   
        </div><!--End of bio tab-->
</section>
</form>